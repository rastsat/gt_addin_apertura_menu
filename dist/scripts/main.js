"use strict";geotab.addin.ioxOutput=function(){var o,i,d,a,c,u,l=function(e){u.innerHTML=e},n=function(e){var t=e+"-"+Date.now(),n=document.createElement("h4"),i=document.createTextNode("Comando enviado: "+new Date);n.setAttribute("id",t),n.appendChild(i),c.appendChild(n),function t(n){setTimeout(function(){o.call("Get",{typeName:"TextMessage",search:{id:n.split("-")[0]}},function(e){e[0].delivered?document.getElementById(n).innerHTML+=", Comando entregado: "+new Date(e[0].delivered):t(n)},l)},500)}(t)},s=function(){var t=d.value;o.call("Add",{typeName:"TextMessage",entity:{device:{id:t},messageContent:{isRelayOn:!0,contentType:"IoxOutput"},isDirectionToVehicle:!0}},function(e){console.log("id de mensaje enviado ".concat(e)),o.call("Add",{typeName:"TextMessage",entity:{device:{id:t},messageContent:{isRelayOn:!1,contentType:"IoxOutput"},isDirectionToVehicle:!0}},n,l)},l)},r=function(e,t){return(e=e.name.toLowerCase())===(t=t.name.toLowerCase())?0:t<e?1:-1};return{initialize:function(e,t,n){o=e,i=document.getElementById("ioxoutput"),d=document.getElementById("ioxoutput-vehicles"),a=document.getElementById("ioxoutput-send"),c=document.getElementById("ioxoutput-history"),u=document.getElementById("ioxoutput-error"),d.addEventListener("change",function(){a.disabled=!1}),a.addEventListener("click",s),n()},focus:function(e){(o=e).call("Get",{typeName:"Device",resultsLimit:1e3,search:{fromDate:(new Date).toISOString()}},function(e){if(e&&!(e.length<1)){e.sort(r),d.innerHTML="";for(var t=0;t<e.length;t++){var n=new Option;n.text=e[t].name,n.value=e[t].id,d.add(n)}a.disabled=!1,i.style.display=""}},l)},blur:function(){a.disabled=!0,i.style.display="none"}}};